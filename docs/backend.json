
{
  "entities": {
    "Transaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Transaction",
      "type": "object",
      "description": "Represents a financial transaction, either income or expense.",
      "properties": {
        "description": {
          "type": "string",
          "description": "A descriptive title for the transaction."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction. Positive for income, negative for expense."
        },
        "category": {
          "type": "string",
          "description": "The category to which the transaction belongs (e.g., 'Food', 'Salary')."
        },
        "date": {
          "type": "string",
          "description": "The date of the transaction.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "enum": [
            "income",
            "expense"
          ]
        },
        "installments": {
          "type": "number"
        },
        "installmentId": {
          "type": "string",
          "description": "Identifier for grouping transactions related to the same installment purchase. Null if not an installment."
        },
        "cardId": {
          "type": "string"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the transaction was created."
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the transaction was last updated."
        }
      },
      "required": [
        "amount",
        "description",
        "category",
        "date",
        "type",
        "installments",
        "createdAt",
        "updatedAt"
      ]
    },
    "CreditCard": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CreditCard",
      "type": "object",
      "description": "Represents a credit card with its associated details.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the credit card (e.g., 'Visa', 'Mastercard')."
        },
        "totalLimit": {
          "type": "number",
          "description": "The credit limit of the card."
        },
        "color": {
          "type": "string"
        },
        "closingDay": {
          "type": "number",
          "description": "The closing day of the card's billing cycle."
        },
        "dueDay": {
          "type": "number",
          "description": "The due day of the card's bill payment."
        }
      },
      "required": [
        "name",
        "totalLimit",
        "color",
        "closingDay",
        "dueDay"
      ]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents user-specific preferences and settings related to AI finance personalities.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile, matching the auth UID."
        },
        "aiPersonality": {
          "type": "string",
          "description": "The selected AI finance personality for the user."
        },
        "aiKnowledgeLevel": {
            "type": "string",
            "description": "The selected AI knowledge level for the user."
        },
        "currency": {
            "type": "string",
            "description": "The user's preferred currency (e.g., 'BRL', 'USD')."
        },
        "firstName": {
            "type": "string"
        },
        "lastName": {
            "type": "string"
        },
        "birthDate": {
            "type": "string",
            "format": "date"
        },
        "city": {
            "type": "string"
        },
        "jobTitle": {
            "type": "string"
        },
        "company": {
            "type": "string"
        },
        "dailyCredits": {
            "type": "number",
            "description": "Number of daily AI interactions remaining."
        },
        "lastCreditReset": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the last daily credit reset."
        },
        "adsWatchedToday": {
            "type": "number",
            "description": "Number of ads watched today for rewards."
        }
      },
      "required": [
        "id",
        "aiPersonality"
      ]
    },
    "CustomCategory": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CustomCategory",
      "type": "object",
      "description": "Represents a user-defined category for transactions.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the custom category."
        },
        "icon": {
          "type": "string",
          "description": "An emoji character representing the category."
        },
        "color": {
          "type": "string",
          "description": "A hex color code for the category."
        },
        "type": {
          "type": "string",
          "enum": ["income", "expense"],
          "description": "The type of transaction this category applies to."
        }
      },
      "required": ["name", "icon", "color", "type"]
    },
    "FinancialGoal": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FinancialGoal",
      "type": "object",
      "description": "Represents a user's financial goal.",
      "properties": {
        "title": {
          "type": "string",
          "description": "The title of the financial goal."
        },
        "targetAmount": {
          "type": "number",
          "description": "The target amount to be saved for the goal."
        },
        "currentAmount": {
          "type": "number",
          "description": "The current amount saved towards the goal."
        },
        "deadline": {
          "type": "string",
          "format": "date",
          "description": "The deadline for achieving the goal."
        },
        "icon": {
          "type": "string",
          "description": "An emoji character representing the goal."
        }
      },
      "required": ["title", "targetAmount", "currentAmount", "deadline", "icon"]
    },
    "ChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatMessage",
      "type": "object",
      "description": "A single message in a chat session.",
      "properties": {
        "role": {
          "type": "string",
          "enum": ["user", "model"],
          "description": "The role of the message sender."
        },
        "content": {
          "type": "string",
          "description": "The text content of the message."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "The time the message was sent."
        }
      },
      "required": ["role", "content", "timestamp"]
    },
    "ChatSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ChatSession",
      "type": "object",
      "description": "Represents a single chat conversation session.",
      "properties": {
        "title": {
          "type": "string",
          "description": "A title for the chat session, often the first user message."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the session was created."
        },
        "personaId": {
          "type": "string",
          "description": "The ID of the AI personality used in this session."
        },
        "knowledgeId": {
            "type": "string",
            "description": "The ID of the AI knowledge level used in this session."
        },
        "messages": {
          "type": "array",
          "items": {
            "$ref": "#/entities/ChatMessage"
          },
          "description": "An array of messages that make up the conversation."
        }
      },
      "required": ["createdAt", "personaId", "knowledgeId", "messages"]
    },
    "Subscription": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Subscription",
        "type": "object",
        "description": "Represents the user's subscription status.",
        "properties": {
            "plan": {
                "type": "string",
                "enum": ["free", "bronze", "silver", "gold", "pro"],
                "description": "The current subscription plan of the user."
            },
            "isActive": {
                "type": "boolean",
                "description": "Whether the subscription is currently active."
            },
            "validUntil": {
                "type": "string",
                "format": "date-time",
                "description": "The date until which the subscription is valid."
            }
        },
        "required": ["plan", "isActive"]
    },
    "AuditLog": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "AuditLog",
        "type": "object",
        "description": "Logs changes to critical user data like transactions.",
        "properties": {
            "actionType": {
                "type": "string",
                "enum": ["CREATE", "UPDATE", "DELETE"],
                "description": "The type of action performed."
            },
            "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "When the action occurred."
            },
            "transactionId": {
                "type": "string",
                "description": "The ID of the affected transaction."
            },
            "previousData": {
                "$ref": "#/entities/Transaction",
                "description": "The state of the data before the change (for UPDATE/DELETE)."
            },
            "newData": {
                "$ref": "#/entities/Transaction",
                "description": "The state of the data after the change (for CREATE/UPDATE)."
            },
            "metadata": {
                "type": "object",
                "properties": {
                    "user_agent": {"type": "string"},
                    "ip_address": {"type": "string"}
                }
            }
        },
        "required": ["actionType", "timestamp", "transactionId"]
    }
  },
  "auth": {
    "providers": [
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/transactions/{transactionId}",
        "definition": {
          "entityName": "Transaction",
          "schema": {
            "$ref": "#/entities/Transaction"
          },
          "description": "Stores financial transaction data for a specific user."
        }
      },
      {
        "path": "/users/{userId}/cards/{cardId}",
        "definition": {
          "entityName": "CreditCard",
          "schema": {
            "$ref": "#/entities/CreditCard"
          },
          "description": "Stores credit card details for a specific user."
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/entities/UserProfile"
          },
          "description": "Stores user profile data including AI personality preferences."
        }
      },
      {
        "path": "/users/{userId}/custom_categories/{categoryId}",
        "definition": {
          "entityName": "CustomCategory",
          "schema": {
            "$ref": "#/entities/CustomCategory"
          },
          "description": "Stores user-defined transaction categories."
        }
      },
      {
        "path": "/users/{userId}/goals/{goalId}",
        "definition": {
          "entityName": "FinancialGoal",
          "schema": {
            "$ref": "#/entities/FinancialGoal"
          },
          "description": "Stores user's financial goals."
        }
      },
      {
        "path": "/users/{userId}/chat_sessions/{sessionId}",
        "definition": {
          "entityName": "ChatSession",
          "schema": {
            "$ref": "#/entities/ChatSession"
          },
          "description": "Stores user's chat conversation history."
        }
      },
      {
          "path": "/users/{userId}/subscription/status",
          "definition": {
              "entityName": "Subscription",
              "schema": { "$ref": "#/entities/Subscription" },
              "description": "A singleton document storing the user's subscription status."
          }
      },
      {
          "path": "/users/{userId}/audit_logs/{logId}",
          "definition": {
              "entityName": "AuditLog",
              "schema": { "$ref": "#/entities/AuditLog" },
              "description": "Stores audit logs for sensitive operations."
          }
      }
    ]
  }
}
